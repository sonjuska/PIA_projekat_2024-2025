<div class="lista-vikendica">
  <h2>Lista vikendica</h2>
  <table class="vikendica-table">
    <thead>
      <tr>
        <th>Naziv</th>
        <th>Mesto</th>
        <th>Usluge</th>
        <th>Telefon</th>
        <th>Blokirana</th>
        <th>Akcija</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let vik of vikendice">
        <td>{{ vik.naziv }}</td>
        <td>{{ vik.mesto }}</td>
        <td>{{ vik.usluge.replaceAll(',', ', ')  }}</td>
        <td>{{ vik.telefon }}</td>
        <td>{{ !vik.blokirana_do? 'NE': 'DA, do '+ (vik.blokirana_do | date:'dd.MM.yyyy. HH:mm')}}</td>
        <td>
            <button class="btn-odobri" (click)="uredi(vik.id)">‚úèÔ∏è</button>
            <button class="btn-odbij" (click)="obrisi(vik.id)">üóëÔ∏è</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="register-container">

  <form class="register-box" (ngSubmit)="dodajVikendicu()" #vikendicaForm="ngForm">
    <h2>Nova vikendica</h2>
    <hr><br>

    <div class="form-group">
        <label for="jsonFile">Uƒçitaj JSON fajl (opciono):</label>
        <input type="file" id="jsonFile" accept=".json" (change)="ucitajJSON($event)" />
    </div>

    <div class="form-group">
      <label for="naziv">Naziv:</label>
      <input type="text" id="naziv" name="naziv" [(ngModel)]="novaVikendica.naziv" required />
    </div>

    <div class="form-group">
      <label for="mesto">Mesto:</label>
      <input type="text" id="mesto" name="mesto" [(ngModel)]="novaVikendica.mesto" required />
    </div>

    <div class="form-group">
    <label for="uslugaInput">Usluge:</label>
    
    <div class="usluga-input-wrapper">
        <input
        type="text"
        id="uslugaInput"
        [(ngModel)]="novaUsluga"
        name="novaUsluga"
        (keydown.enter)="dodajUslugu(); $event.preventDefault();"
        placeholder="Unesite uslugu i pritisnite Enter"
        />
        <button type="button" class="btn" (click)="dodajUslugu()">Dodaj</button>
    </div>

    <!-- Ovde se vide sve usluge koje su do sad unete -->
    <div class="usluge-list">
        <span
        class="usluga-tag"
        *ngFor="let usluga of usluge; let i = index"
        >
        {{ usluga }}
        <button type="button" (click)="ukloniUslugu(i)">√ó</button>
        </span>
    </div>
    </div>

    <div class="form-group">
      <label for="telefon">Telefon:</label>
      <input type="text" id="telefon" name="telefon" [(ngModel)]="novaVikendica.telefon"   pattern="^(\+?[0-9]{0,})$" (keypress)="dozvoliSamoBrojeve($event)"/>
    </div>

    <div class="form-group">
      <label for="lat">Geografska ≈°irina (lat):</label>
      <input type="number" step="any" id="lat" name="lat" [(ngModel)]="novaVikendica.lat" required />
    </div>

    <div class="form-group">
      <label for="lon">Geografska du≈æina (lon):</label>
      <input type="number" step="any" id="lon" name="lon" [(ngModel)]="novaVikendica.lon" required />
    </div>

    <div class="form-group">
      <label for="blokirana_do">Blokirana do:</label>
      <input type="datetime-local" id="blokirana_do" name="blokirana_do" [(ngModel)]="novaVikendica.blokirana_do" />
    </div><br>

    <div class="form-group">
    <label>Cenovnik:</label>

    <div *ngFor="let stavka of cenovnik; let i = index" class="cenovnik-item">
            <select [(ngModel)]="stavka.sezona" name="sezona{{i}}" required>
            <option value="" disabled>Odaberi sezonu</option>
            <option value="leto">Leto</option>
            <option value="zima">Zima</option>
            </select>
            <input type="number" step="0.01" [(ngModel)]="stavka.cena" name="cena{{i}}" placeholder="Cena" required />
            <button type="button" class="X" (click)="ukloniCenovnik(i)">‚ùå</button> <br>

    </div>

    <button type="button" class="btn" (click)="dodajCenovnik()">+ Dodaj stavku</button><br>
    </div>

    <div class="form-group">
        <label for="slike">Slike vikendice:</label>
        <input 
            type="file" 
            id="slike" 
            name="slike" 
            (change)="onSlikeSelected($event)" 
            multiple
        />
        </div>

        <!--slike sa dugmetom za brisanje -->
        <div class="slike-preview">
        <div class="slika-item" *ngFor="let slika of slikePreview; let i = index">
            <img 
            [src]="slika" 
            alt="Slika vikendice" 
            width="100" 
            style="margin: 5px; border-radius: 4px;"
            />
            <button 
            type="button" 
            class="btn-odbij" 
            (click)="ukloniSliku(i)">
            ‚ùå
            </button>
        </div>
        </div>

    <button type="submit" class="btn" [disabled]="!vikendicaForm.form.valid">Dodaj</button>
  </form>
</div>
